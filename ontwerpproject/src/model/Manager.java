package model;


import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import java.net.InetSocketAddress;
import java.sql.Connection;
import java.util.ArrayList;
import java.util.List;

import model.intelligence.Intelligence.ClosedException;
import model.intelligence.ManagerIntelligence;

/**
 * Represents a clustermanager in the query system
 * 
 * @author Jeroen
 *
 */
public class Manager extends Component {

	public Manager(InetSocketAddress addr, Connection con, Model mod) throws ClosedException {
		super(addr, con);
		intel = new ManagerIntelligence(this, mod, con);
		//TODO temp currentlyplaceholder
		String[] temp = {"cms_version", "cms_start_time", "cms_now_time", "cms_tot_domains", "cms_doms_today", "cms_worker_count", "w[00].addr", "w[00].start_time", "w[00].chunk_start_time", "w[00].now_time", "w[00].measure_q_len", "w[00].results_q_len", "w[00].total_scanned", "w[00].state", "w[01].addr", "w[01].start_time", "w[01].chunk_start_time", "w[01].now_time", "w[01].measure_q_len", "w[01].results_q_len", "w[01].total_scanned", "w[01].state", "w[02].addr", "w[02].start_time", "w[02].chunk_start_time", "w[02].now_time", "w[02].measure_q_len", "w[02].results_q_len", "w[02].total_scanned", "w[02].state", "w[03].addr", "w[03].start_time", "w[03].chunk_start_time", "w[03].now_time", "w[03].measure_q_len", "w[03].results_q_len", "w[03].total_scanned", "w[03].state", "w[04].addr", "w[04].start_time", "w[04].chunk_start_time", "w[04].now_time", "w[04].measure_q_len", "w[04].results_q_len", "w[04].total_scanned", "w[04].state", "w[05].addr", "w[05].start_time", "w[05].chunk_start_time", "w[05].now_time", "w[05].measure_q_len", "w[05].results_q_len", "w[05].total_scanned", "w[05].state", "w[06].addr", "w[06].start_time", "w[06].chunk_start_time", "w[06].now_time", "w[06].measure_q_len", "w[06].results_q_len", "w[06].total_scanned", "w[06].state", "w[07].addr", "w[07].start_time", "w[07].chunk_start_time", "w[07].now_time", "w[07].measure_q_len", "w[07].results_q_len", "w[07].total_scanned", "w[07].state", "w[08].addr", "w[08].start_time", "w[08].chunk_start_time", "w[08].now_time", "w[08].measure_q_len", "w[08].results_q_len", "w[08].total_scanned", "w[08].state", "w[09].addr", "w[09].start_time", "w[09].chunk_start_time", "w[09].now_time", "w[09].measure_q_len", "w[09].results_q_len", "w[09].total_scanned", "w[09].state", "w[10].addr", "w[10].start_time", "w[10].chunk_start_time", "w[10].now_time", "w[10].measure_q_len", "w[10].results_q_len", "w[10].total_scanned", "w[10].state", "w[11].addr", "w[11].start_time", "w[11].chunk_start_time", "w[11].now_time", "w[11].measure_q_len", "w[11].results_q_len", "w[11].total_scanned", "w[11].state", "w[12].addr", "w[12].start_time", "w[12].chunk_start_time", "w[12].now_time", "w[12].measure_q_len", "w[12].results_q_len", "w[12].total_scanned", "w[12].state", "w[13].addr", "w[13].start_time", "w[13].chunk_start_time", "w[13].now_time", "w[13].measure_q_len", "w[13].results_q_len", "w[13].total_scanned", "w[13].state", "w[14].addr", "w[14].start_time", "w[14].chunk_start_time", "w[14].now_time", "w[14].measure_q_len", "w[14].results_q_len", "w[14].total_scanned", "w[14].state", "w[15].addr", "w[15].start_time", "w[15].chunk_start_time", "w[15].now_time", "w[15].measure_q_len", "w[15].results_q_len", "w[15].total_scanned", "w[15].state", "w[16].addr", "w[16].start_time", "w[16].chunk_start_time", "w[16].now_time", "w[16].measure_q_len", "w[16].results_q_len", "w[16].total_scanned", "w[16].state", "w[17].addr", "w[17].start_time", "w[17].chunk_start_time", "w[17].now_time", "w[17].measure_q_len", "w[17].results_q_len", "w[17].total_scanned", "w[17].state", "w[18].addr", "w[18].start_time", "w[18].chunk_start_time", "w[18].now_time", "w[18].measure_q_len", "w[18].results_q_len", "w[18].total_scanned", "w[18].state", "w[19].addr", "w[19].start_time", "w[19].chunk_start_time", "w[19].now_time", "w[19].measure_q_len", "w[19].results_q_len", "w[19].total_scanned", "w[19].state", "w[20].addr", "w[20].start_time", "w[20].chunk_start_time", "w[20].now_time", "w[20].measure_q_len", "w[20].results_q_len", "w[20].total_scanned", "w[20].state", "w[21].addr", "w[21].start_time", "w[21].chunk_start_time", "w[21].now_time", "w[21].measure_q_len", "w[21].results_q_len", "w[21].total_scanned", "w[21].state", "w[22].addr", "w[22].start_time", "w[22].chunk_start_time", "w[22].now_time", "w[22].measure_q_len", "w[22].results_q_len", "w[22].total_scanned", "w[22].state", "w[23].addr", "w[23].start_time", "w[23].chunk_start_time", "w[23].now_time", "w[23].measure_q_len", "w[23].results_q_len", "w[23].total_scanned", "w[23].state", "w[24].addr", "w[24].start_time", "w[24].chunk_start_time", "w[24].now_time", "w[24].measure_q_len", "w[24].results_q_len", "w[24].total_scanned", "w[24].state", "w[25].addr", "w[25].start_time", "w[25].chunk_start_time", "w[25].now_time", "w[25].measure_q_len", "w[25].results_q_len", "w[25].total_scanned", "w[25].state", "w[26].addr", "w[26].start_time", "w[26].chunk_start_time", "w[26].now_time", "w[26].measure_q_len", "w[26].results_q_len", "w[26].total_scanned", "w[26].state", "w[27].addr", "w[27].start_time", "w[27].chunk_start_time", "w[27].now_time", "w[27].measure_q_len", "w[27].results_q_len", "w[27].total_scanned", "w[27].state", "w[28].addr", "w[28].start_time", "w[28].chunk_start_time", "w[28].now_time", "w[28].measure_q_len", "w[28].results_q_len", "w[28].total_scanned", "w[28].state", "w[29].addr", "w[29].start_time", "w[29].chunk_start_time", "w[29].now_time", "w[29].measure_q_len", "w[29].results_q_len", "w[29].total_scanned", "w[29].state", "w[30].addr", "w[30].start_time", "w[30].chunk_start_time", "w[30].now_time", "w[30].measure_q_len", "w[30].results_q_len", "w[30].total_scanned", "w[30].state", "w[31].addr", "w[31].start_time", "w[31].chunk_start_time", "w[31].now_time", "w[31].measure_q_len", "w[31].results_q_len", "w[31].total_scanned", "w[31].state", "w[32].addr", "w[32].start_time", "w[32].chunk_start_time", "w[32].now_time", "w[32].measure_q_len", "w[32].results_q_len", "w[32].total_scanned", "w[32].state", "w[33].addr", "w[33].start_time", "w[33].chunk_start_time", "w[33].now_time", "w[33].measure_q_len", "w[33].results_q_len", "w[33].total_scanned", "w[33].state", "w[34].addr", "w[34].start_time", "w[34].chunk_start_time", "w[34].now_time", "w[34].measure_q_len", "w[34].results_q_len", "w[34].total_scanned", "w[34].state", "w[35].addr", "w[35].start_time", "w[35].chunk_start_time", "w[35].now_time", "w[35].measure_q_len", "w[35].results_q_len", "w[35].total_scanned", "w[35].state", "w[36].addr", "w[36].start_time", "w[36].chunk_start_time", "w[36].now_time", "w[36].measure_q_len", "w[36].results_q_len", "w[36].total_scanned", "w[36].state", "w[37].addr", "w[37].start_time", "w[37].chunk_start_time", "w[37].now_time", "w[37].measure_q_len", "w[37].results_q_len", "w[37].total_scanned", "w[37].state", "w[38].addr", "w[38].start_time", "w[38].chunk_start_time", "w[38].now_time", "w[38].measure_q_len", "w[38].results_q_len", "w[38].total_scanned", "w[38].state", "w[39].addr", "w[39].start_time", "w[39].chunk_start_time", "w[39].now_time", "w[39].measure_q_len", "w[39].results_q_len", "w[39].total_scanned", "w[39].state", "w[40].addr", "w[40].start_time", "w[40].chunk_start_time", "w[40].now_time", "w[40].measure_q_len", "w[40].results_q_len", "w[40].total_scanned", "w[40].state", "w[41].addr", "w[41].start_time", "w[41].chunk_start_time", "w[41].now_time", "w[41].measure_q_len", "w[41].results_q_len", "w[41].total_scanned", "w[41].state", "w[42].addr", "w[42].start_time", "w[42].chunk_start_time", "w[42].now_time", "w[42].measure_q_len", "w[42].results_q_len", "w[42].total_scanned", "w[42].state", "w[43].addr", "w[43].start_time", "w[43].chunk_start_time", "w[43].now_time", "w[43].measure_q_len", "w[43].results_q_len", "w[43].total_scanned", "w[43].state", "w[44].addr", "w[44].start_time", "w[44].chunk_start_time", "w[44].now_time", "w[44].measure_q_len", "w[44].results_q_len", "w[44].total_scanned", "w[44].state", "w[45].addr", "w[45].start_time", "w[45].chunk_start_time", "w[45].now_time", "w[45].measure_q_len", "w[45].results_q_len", "w[45].total_scanned", "w[45].state", "w[46].addr", "w[46].start_time", "w[46].chunk_start_time", "w[46].now_time", "w[46].measure_q_len", "w[46].results_q_len", "w[46].total_scanned", "w[46].state", "w[47].addr", "w[47].start_time", "w[47].chunk_start_time", "w[47].now_time", "w[47].measure_q_len", "w[47].results_q_len", "w[47].total_scanned", "w[47].state", "w[48].addr", "w[48].start_time", "w[48].chunk_start_time", "w[48].now_time", "w[48].measure_q_len", "w[48].results_q_len", "w[48].total_scanned", "w[48].state", "w[49].addr", "w[49].start_time", "w[49].chunk_start_time", "w[49].now_time", "w[49].measure_q_len", "w[49].results_q_len", "w[49].total_scanned", "w[49].state", "w[50].addr", "w[50].start_time", "w[50].chunk_start_time", "w[50].now_time", "w[50].measure_q_len", "w[50].results_q_len", "w[50].total_scanned", "w[50].state", "w[51].addr", "w[51].start_time", "w[51].chunk_start_time", "w[51].now_time", "w[51].measure_q_len", "w[51].results_q_len", "w[51].total_scanned", "w[51].state", "w[52].addr", "w[52].start_time", "w[52].chunk_start_time", "w[52].now_time", "w[52].measure_q_len", "w[52].results_q_len", "w[52].total_scanned", "w[52].state", "w[53].addr", "w[53].start_time", "w[53].chunk_start_time", "w[53].now_time", "w[53].measure_q_len", "w[53].results_q_len", "w[53].total_scanned", "w[53].state", "w[54].addr", "w[54].start_time", "w[54].chunk_start_time", "w[54].now_time", "w[54].measure_q_len", "w[54].results_q_len", "w[54].total_scanned", "w[54].state", "w[55].addr", "w[55].start_time", "w[55].chunk_start_time", "w[55].now_time", "w[55].measure_q_len", "w[55].results_q_len", "w[55].total_scanned", "w[55].state", "w[56].addr", "w[56].start_time", "w[56].chunk_start_time", "w[56].now_time", "w[56].measure_q_len", "w[56].results_q_len", "w[56].total_scanned", "w[56].state", "w[57].addr", "w[57].start_time", "w[57].chunk_start_time", "w[57].now_time", "w[57].measure_q_len", "w[57].results_q_len", "w[57].total_scanned", "w[57].state", "w[58].addr", "w[58].start_time", "w[58].chunk_start_time", "w[58].now_time", "w[58].measure_q_len", "w[58].results_q_len", "w[58].total_scanned", "w[58].state", "w[59].addr", "w[59].start_time", "w[59].chunk_start_time", "w[59].now_time", "w[59].measure_q_len", "w[59].results_q_len", "w[59].total_scanned", "w[59].state", "w[60].addr", "w[60].start_time", "w[60].chunk_start_time", "w[60].now_time", "w[60].measure_q_len", "w[60].results_q_len", "w[60].total_scanned", "w[60].state", "w[61].addr", "w[61].start_time", "w[61].chunk_start_time", "w[61].now_time", "w[61].measure_q_len", "w[61].results_q_len", "w[61].total_scanned", "w[61].state", "w[62].addr", "w[62].start_time", "w[62].chunk_start_time", "w[62].now_time", "w[62].measure_q_len", "w[62].results_q_len", "w[62].total_scanned", "w[62].state", "w[63].addr", "w[63].start_time", "w[63].chunk_start_time", "w[63].now_time", "w[63].measure_q_len", "w[63].results_q_len", "w[63].total_scanned", "w[63].state", "w[64].addr", "w[64].start_time", "w[64].chunk_start_time", "w[64].now_time", "w[64].measure_q_len", "w[64].results_q_len", "w[64].total_scanned", "w[64].state", "w[65].addr", "w[65].start_time", "w[65].chunk_start_time", "w[65].now_time", "w[65].measure_q_len", "w[65].results_q_len", "w[65].total_scanned", "w[65].state", "w[66].addr", "w[66].start_time", "w[66].chunk_start_time", "w[66].now_time", "w[66].measure_q_len", "w[66].results_q_len", "w[66].total_scanned", "w[66].state", "w[67].addr", "w[67].start_time", "w[67].chunk_start_time", "w[67].now_time", "w[67].measure_q_len", "w[67].results_q_len", "w[67].total_scanned", "w[67].state", "w[68].addr", "w[68].start_time", "w[68].chunk_start_time", "w[68].now_time", "w[68].measure_q_len", "w[68].results_q_len", "w[68].total_scanned", "w[68].state", "w[69].addr", "w[69].start_time", "w[69].chunk_start_time", "w[69].now_time", "w[69].measure_q_len", "w[69].results_q_len", "w[69].total_scanned", "w[69].state", "w[70].addr", "w[70].start_time", "w[70].chunk_start_time", "w[70].now_time", "w[70].measure_q_len", "w[70].results_q_len", "w[70].total_scanned", "w[70].state", "w[71].addr", "w[71].start_time", "w[71].chunk_start_time", "w[71].now_time", "w[71].measure_q_len", "w[71].results_q_len", "w[71].total_scanned", "w[71].state", "w[72].addr", "w[72].start_time", "w[72].chunk_start_time", "w[72].now_time", "w[72].measure_q_len", "w[72].results_q_len", "w[72].total_scanned", "w[72].state", "w[73].addr", "w[73].start_time", "w[73].chunk_start_time", "w[73].now_time", "w[73].measure_q_len", "w[73].results_q_len", "w[73].total_scanned", "w[73].state", "w[74].addr", "w[74].start_time", "w[74].chunk_start_time", "w[74].now_time", "w[74].measure_q_len", "w[74].results_q_len", "w[74].total_scanned", "w[74].state", "w[75].addr", "w[75].start_time", "w[75].chunk_start_time", "w[75].now_time", "w[75].measure_q_len", "w[75].results_q_len", "w[75].total_scanned", "w[75].state", "w[76].addr", "w[76].start_time", "w[76].chunk_start_time", "w[76].now_time", "w[76].measure_q_len", "w[76].results_q_len", "w[76].total_scanned", "w[76].state", "w[77].addr", "w[77].start_time", "w[77].chunk_start_time", "w[77].now_time", "w[77].measure_q_len", "w[77].results_q_len", "w[77].total_scanned", "w[77].state", "w[78].addr", "w[78].start_time", "w[78].chunk_start_time", "w[78].now_time", "w[78].measure_q_len", "w[78].results_q_len", "w[78].total_scanned", "w[78].state", "w[79].addr", "w[79].start_time", "w[79].chunk_start_time", "w[79].now_time", "w[79].measure_q_len", "w[79].results_q_len", "w[79].total_scanned", "w[79].state"};
		collumnList = temp;
	}

	@Override
	protected String[] parseInput(String message) {
		String[] parts;
		List<String> result = new ArrayList<String>();
		String currentLine;
		try{
			BufferedReader br = new BufferedReader(new FileReader(message));
			while((currentLine = br.readLine()) != null){
				if(!currentLine.contains("last")){
					parts = currentLine.split(":");
					currentLine = parts[1];
					currentLine = currentLine.replace(" ", "");
					result.add(currentLine);
				}
			}
			br.close();
		}catch (IOException e){
			e.printStackTrace();
			//TODO: weet niet of hier nog een email error zou moeten ofzo?
		}
		return (String[]) result.toArray();
	}

	@Override
	public String getTableName() {
		return "m" + super.getTableName();
	}

}
